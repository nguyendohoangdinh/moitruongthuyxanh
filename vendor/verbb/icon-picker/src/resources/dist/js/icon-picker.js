void 0===Craft.IconPicker&&(Craft.IconPicker={}),function(e){Craft.IconPicker.Input=Garnish.Base.extend({$container:null,$selectize:null,$spinner:null,$errorText:null,iconData:null,preppedIconData:{},init:function(i){this.options=i;var n=this;this.loadSpriteSheets(),this.loadFonts(),this.$container=e("#"+i.inputId),this.$selectize=this.$container.find(".icon-picker-select"),this.$spinner=this.$container.find(".spinner"),this.$errorText=this.$container.find(".error-text"),this.fixClipping(),this.$selectize.selectize({maxItems:1,maxOptions:i.settings.maxIconsShown,valueField:"value",labelField:"label",searchField:["label","description"],options:[],optgroups:[],optgroupField:"parent_id",create:!1,preload:"focus",render:{item:function(e,i){if("svg"==e.type)var n='<img src="'+e.url+'" alt="'+i(e.label)+'" />';else if("sprite"==e.type)var n='<svg viewBox="0 0 1000 1000"><use xlink:href="#'+e.url+'" /></svg>';else if("glyph"==e.type)var n='<span class="icon-picker-font font-face-'+e.name+'">'+e.url+"</span>";else if("css"==e.type)var n='<span class="icon-picker-font '+e.classes+'">'+e.url+"</span>";return'<div class="icon-picker-thumb"><div class="icon-picker-thumb-icon">'+n+"</div><span>"+i(e.label)+"</span></div>"},option:function(e,i){if("svg"==e.type)var t='<img src="'+e.url+'" alt="'+i(e.label)+'" title="'+i(e.label)+'" />';else if("sprite"==e.type)var t='<svg viewBox="0 0 1000 1000"><use xlink:href="#'+e.url+'" /></svg>';else if("glyph"==e.type)var t='<span class="icon-picker-font font-face-'+e.name+'">'+e.url+"</span>";else if("css"==e.type)var t='<span class="icon-picker-font '+e.classes+'">'+e.url+"</span>";var s;return'<div class="icon-picker-item"><div class="icon-picker-item-wrap"><div class="icon-picker-item-icon">'+t+'</div><span class="icon-picker-item-label">'+(n.options.settings.showLabels?i(e.label):"")+"</span></div></div>"}},load:function(t,s){if(n.$spinner.removeClass("hidden"),n.$errorText.html(""),!e.isEmptyObject(n.preppedIconData))return n.$spinner.addClass("hidden"),s(n.preppedIconData);var r=n.$selectize[0].selectize,a=[],o=0;e.ajax({url:Craft.getActionUrl("icon-picker/icons/icons-for-field",{fieldId:i.fieldId}),type:"GET",error:function(e){n.$spinner.addClass("hidden"),n.$errorText.html(e.statusText),s()},success:function(i){e.each(i,(function(i,n){var t={id:o,label:i};r.addOptionGroup(t.id,t),e.each(n,(function(e,i){i.parent_id=t.id,a.push(i)})),o++})),n.preppedIconData=a,n.$spinner.addClass("hidden"),s(n.preppedIconData)}})}})},fixClipping:function(){var e=this.$container.parents(".ni_block");e.length&&(e.css({overflow:"visible"}),e.find(".ni_block_body").css({overflow:"visible"}))},loadFonts:function(){for(var i=0;i<this.options.fonts.length;i++){var n=this.options.fonts[i];if(-1==e.inArray(n.name,Craft.IconPicker.Cache.fonts))if(Craft.IconPicker.Cache.fonts.push(n.name),"local"==n.type){var t='@font-face {font-family: "'+n.name+'";src: url("'+n.url+'");font-weight: normal;font-style: normal;}.'+n.name+' {font-family: "'+n.name+'" !important;}';e("head").append('<style type="text/css">'+t+"</style>")}else"remote"==n.type&&e("head").append('<link rel="stylesheet" type="text/css" href="'+n.url+'">')}},loadSpriteSheets:function(){for(var i=0;i<this.options.spriteSheets.length;i++){var n=this.options.spriteSheets[i];-1==e.inArray(n.name,Craft.IconPicker.Cache.stylesheets)&&(Craft.IconPicker.Cache.stylesheets.push(n.name),e.get(n.url,(function(i){var t=document.createElement("div");t.innerHTML=(new XMLSerializer).serializeToString(i.documentElement),$svg=e(t).find("> svg"),$svg.attr("id","icon-picker-spritesheet-"+n.name),$svg.css("display","none").prependTo("body")})))}}})}(jQuery);
//# sourceMappingURL=icon-picker.js.map